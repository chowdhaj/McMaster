Assignment Notebook 7.3: Correctness of `rev`

Lemma (420): (ys âŒ¢ xs) â–¹ x = ys âŒ¢ (xs â–¹ x)
Proof:
    By induction on `ys : Seq A`:
        Base case:
            (ğœ– âŒ¢ xs) â–¹ x = ğœ– âŒ¢ (xs â–¹ x)
          = âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ©
            xs â–¹ x = (xs â–¹ x)
          = âŸ¨ â€œReflexivity of =â€ âŸ©
            true 
        Induction step `âˆ€ y : A â€¢ ((y â—ƒ ys) âŒ¢ xs) â–¹ x = (y â—ƒ ys) âŒ¢ (xs â–¹ x)`:
            For any `y`:
                ((y â—ƒ ys) âŒ¢ xs) â–¹ x = (y â—ƒ ys) âŒ¢ (xs â–¹ x)
              = âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
                ((y â—ƒ ys) âŒ¢ xs) â–¹ x = (y â—ƒ (ys âŒ¢ (xs â–¹ x)))
              = âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
                (y â—ƒ (ys âŒ¢ xs)) â–¹ x = (y â—ƒ (ys âŒ¢ (xs â–¹ x)))
              = âŸ¨ â€œDefinition of â–¹ for â—ƒâ€ âŸ©
                y â—ƒ ((ys âŒ¢ xs) â–¹ x) = (y â—ƒ (ys âŒ¢ (xs â–¹ x))) 
              = âŸ¨ Induction hypothesis âŸ©
                y â—ƒ (ys âŒ¢ (xs â–¹ x)) = y â—ƒ (ys âŒ¢ (xs â–¹ x))
              = âŸ¨ â€œReflexivity of =â€ âŸ© 
                true 

Theorem â€œReverse of âŒ¢â€:
   reverse (xs âŒ¢ ys) = reverse ys âŒ¢ reverse xs
Proof:
    By induction on `xs : Seq A`:
        Base case:
            reverse (ğœ– âŒ¢ ys) = reverse ys âŒ¢ reverse ğœ–
          = âŸ¨ â€œDefinition of âŒ¢ for ğœ–â€ âŸ©
            reverse ys = reverse ys âŒ¢ reverse ğœ–
          = âŸ¨ â€œDefinition of `reverse` for ğœ–â€ âŸ© 
            reverse ys = reverse ys âŒ¢ ğœ–
          = âŸ¨ â€œRight-identity of âŒ¢â€ âŸ© 
            reverse ys = reverse ys
          = âŸ¨ â€œReflexivity of =â€ âŸ©
            true  
        Induction step `âˆ€ x : A â€¢ reverse ((x â—ƒ xs) âŒ¢ ys) = reverse ys âŒ¢ reverse (x â—ƒ xs)`:
            For any `x`:
                reverse ((x â—ƒ xs) âŒ¢ ys) = reverse ys âŒ¢ reverse (x â—ƒ xs)
              = âŸ¨ â€œMutual associativity of â—ƒ with âŒ¢â€ âŸ©
                reverse (x â—ƒ (xs âŒ¢ ys)) = reverse ys âŒ¢ reverse (x â—ƒ xs)
              = âŸ¨ â€œDefinition of `reverse` for â—ƒâ€ âŸ©
                reverse (xs âŒ¢ ys) â–¹ x = reverse ys âŒ¢ reverse (x â—ƒ xs) 
              = âŸ¨ â€œDefinition of `reverse` for â—ƒâ€ âŸ©
                reverse (xs âŒ¢ ys) â–¹ x = reverse ys âŒ¢ reverse xs â–¹ x
              = âŸ¨ Induction hypothesis âŸ©
                (reverse ys âŒ¢ reverse xs) â–¹ x = reverse ys âŒ¢ (reverse xs â–¹ x)
              = âŸ¨ (420) âŸ©  
                true 

Theorem â€œNon-empty-sequence extensionalityâ€:
    xs â‰  ğœ– â‡’ xs = head xs â—ƒ tail xs
Proof:
    By induction on `xs : Seq A`:
        Base case:
            ğœ– â‰  ğœ– â‡’ ğœ– = head ğœ– â—ƒ tail ğœ– 
          = âŸ¨ â€œIrreflexivity of â‰ â€ âŸ©
            false â‡’ ğœ– = head ğœ– â—ƒ tail ğœ– 
          = âŸ¨ â€œex falso quodlibetâ€ âŸ©
            true
        Induction step `âˆ€ x : A â€¢ x â—ƒ xs â‰  ğœ– â‡’ x â—ƒ xs = (head (x â—ƒ xs)) â—ƒ (tail (x â—ƒ xs))`:
            For any `x`:
                x â—ƒ xs â‰  ğœ– â‡’ x â—ƒ xs = (head (x â—ƒ xs)) â—ƒ (tail (x â—ƒ xs))
              = âŸ¨ â€œDefinition of `head`â€ âŸ©
                x â—ƒ xs â‰  ğœ– â‡’ x â—ƒ xs = x â—ƒ (tail (x â—ƒ xs)) 
              = âŸ¨ â€œDefinition of `tail`â€ âŸ©
                x â—ƒ xs â‰  ğœ– â‡’ x â—ƒ xs = x â—ƒ xs
              = âŸ¨ â€œReflexivity of =â€ âŸ© 
                x â—ƒ xs â‰  ğœ– â‡’ true
              = âŸ¨ â€œRight-zero of â‡’â€ âŸ© 
                true

Theorem â€œInitialisation for `rev`â€:
      true
    â‡’â… xs := xsâ‚€ â¨¾ ys := ğœ– â†
      reverse xs âŒ¢ ys = reverse xsâ‚€
Proof:
    reverse xs âŒ¢ ys = reverse xsâ‚€
  â… ys := ğœ– â†â‡ âŸ¨ â€œAssignmentâ€ with Substitution âŸ©
    reverse xs âŒ¢ ğœ– = reverse xsâ‚€  
  = âŸ¨ â€œRight-identity of âŒ¢â€ âŸ©
    reverse xs = reverse xsâ‚€   
  â… xs := xsâ‚€ â†â‡ âŸ¨ â€œAssignmentâ€ with Substitution âŸ©
    reverse xsâ‚€ = reverse xsâ‚€
  = âŸ¨ â€œReflexivity of =â€ âŸ©
    true 
     
Lemma (69): (xs âŒ¢ (x â—ƒ ys)) = ((xs â–¹ x) âŒ¢ ys)
Proof:
    By induction on `xs : Seq A`:
        Base case:
            (ğœ– âŒ¢ (x â—ƒ ys)) 
          = âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ©
            (x â—ƒ ys)
          = âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ© 
            (x â—ƒ (ğœ– âŒ¢ ys))
          = âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
            ((x â—ƒ ğœ–) âŒ¢ ys) 
          = âŸ¨ â€œDefinition of â–¹ for ğœ–â€ âŸ© 
            ((ğœ– â–¹ x) âŒ¢ ys)
        Induction step:
            For any `z`:
                ((z â—ƒ xs) â–¹ x) âŒ¢ ys = (z â—ƒ xs) âŒ¢ (x â—ƒ ys)
              = âŸ¨ â€œDefinition of â–¹ for â—ƒâ€ âŸ©
                (z â—ƒ (xs â–¹ x)) âŒ¢ ys = ((z â—ƒ xs) âŒ¢ (x â—ƒ ys)) 
              = âŸ¨ â€œMutual associativity of â—ƒ with âŒ¢â€ âŸ©
                (z â—ƒ (xs â–¹ x) âŒ¢ ys) = ((z â—ƒ xs) âŒ¢ (x â—ƒ ys)) 
              = âŸ¨ Induction hypothesis âŸ©
                (z â—ƒ xs âŒ¢ (x â—ƒ ys)) = ((z â—ƒ xs) âŒ¢ (x â—ƒ ys)) 
              = âŸ¨ â€œMutual associativity of â—ƒ with âŒ¢â€ âŸ©
                ((z â—ƒ xs) âŒ¢ (x â—ƒ ys)) = ((z â—ƒ xs) âŒ¢ (x â—ƒ ys))  
              = âŸ¨ â€œReflexivity of =â€ âŸ©
                true 
                 
Theorem â€œInvariant for `rev`â€:
      xs â‰  ğœ– âˆ§ reverse xs âŒ¢ ys = reverse xsâ‚€
    â‡’â… ys := head xs â—ƒ ys â¨¾ xs := tail xs â†
      reverse xs âŒ¢ ys = reverse xsâ‚€
Proof:
    reverse xs âŒ¢ ys = reverse xsâ‚€
  â… xs := tail xs â†â‡ âŸ¨ â€œAssignmentâ€ with substitution âŸ©  
    reverse (tail xs) âŒ¢ ys = reverse xsâ‚€
  â… ys := head xs â—ƒ ys â†â‡ âŸ¨ â€œAssignmentâ€ with substitution âŸ© 
    reverse (tail xs) âŒ¢ (head xs â—ƒ ys) = reverse xsâ‚€
  â‰¡ âŸ¨ (69) âŸ© 
    ((reverse (tail xs) â–¹ head xs) âŒ¢ ys = reverse xsâ‚€)
  â‰¡ âŸ¨ â€œDefinition of `reverse` for â—ƒâ€ âŸ© 
    (reverse (head xs â—ƒ tail xs) âŒ¢ ys = reverse xsâ‚€)
  â‡ âŸ¨ â€œWeakeningâ€ âŸ© 
    (xs = head xs â—ƒ tail xs) âˆ§ (reverse (head xs â—ƒ tail xs) âŒ¢ ys = reverse xsâ‚€)
  â‰¡âŸ¨ Substitution âŸ©
    (xs = head xs â—ƒ tail xs) âˆ§ (reverse (z) âŒ¢ ys = reverse xsâ‚€)[z â‰” head xs â—ƒ tail xs]
  â‰¡âŸ¨ â€œReplacementâ€ âŸ©
    (xs = head xs â—ƒ tail xs) âˆ§ (reverse (z) âŒ¢ ys = reverse xsâ‚€)[z â‰” xs]
  â‰¡âŸ¨ Substitution âŸ© 
    (xs = head xs â—ƒ tail xs) âˆ§ (reverse xs âŒ¢ ys = reverse xsâ‚€)
  â‡ âŸ¨ â€œMonotonicity of âˆ§â€ with â€œNon-empty-sequence extensionalityâ€ âŸ©
    xs â‰  ğœ– âˆ§ reverse xs âŒ¢ ys = reverse xsâ‚€

=== MIDTERM 2 QUESTION ===
===       BELOW        ===

Axiom â€œDefinition of `sum` for â—ƒâ€: sum (x â—ƒ xs) = x + sum xs

Theorem â€œInitialisation for `Sum`â€:
      true
    â‡’â… xs := xsâ‚€ â¨¾ s := 0 â†
      s + sum xs = sum xsâ‚€
Proof:
    s + sum xs = sum xsâ‚€
  â… s := 0 â†â‡ âŸ¨ â€œAssignmentâ€ with substitution âŸ©
    0 + sum xs = sum xsâ‚€
  â‰¡ âŸ¨ â€œIdentity of +â€ âŸ©
    sum xs = sum xsâ‚€
  â… xs := xsâ‚€  â†â‡ âŸ¨ â€œAssignmentâ€ with substitution âŸ© 
    sum xsâ‚€ = sum xsâ‚€
  â‰¡ âŸ¨ â€œReflexivity of =â€ âŸ©
    true 

Theorem â€œInvariant for `Sum`â€: 
    xs â‰  ğœ– âˆ§ s + sum xs = sum xsâ‚€ 
  â‡’â… (s := s + head xs â¨¾ xs := tail xs) â† 
    s + sum xs = sum xsâ‚€
Proof:
    s + sum xs = sum xsâ‚€
  â… xs := tail xs â†â‡ âŸ¨ â€œAssignmentâ€ with Substitution âŸ©
    s + sum (tail xs) = sum xsâ‚€
  â… s := s + head xs â†â‡ âŸ¨ â€œAssignmentâ€ with Substitution âŸ© 
    s + head xs + sum (tail xs) = sum xsâ‚€
  â‰¡ âŸ¨ â€œDefinition of `sum` for â—ƒâ€ âŸ©
    (s + sum (head xs â—ƒ tail xs) = sum xsâ‚€)
  â‡ âŸ¨ â€œWeakeningâ€ âŸ©
    (xs = head xs â—ƒ tail xs) âˆ§ (s + sum (head xs â—ƒ tail xs) = sum xsâ‚€)
  â‰¡ âŸ¨ Substitution âŸ©
    (xs = head xs â—ƒ tail xs) âˆ§ (s + sum z = sum xsâ‚€)[z â‰” head xs â—ƒ tail xs] 
  â‰¡ âŸ¨ â€œReplacementâ€ âŸ©
    (xs = head xs â—ƒ tail xs) âˆ§ (s + sum z = sum xsâ‚€)[z â‰” xs]
  â‰¡ âŸ¨ Substitution âŸ© 
    (xs = head xs â—ƒ tail xs) âˆ§ (s + sum xs = sum xsâ‚€)
  â‡ âŸ¨ â€œMonotonicity of âˆ§â€ with â€œNon-empty-sequence extensionalityâ€ âŸ©
    xs â‰  ğœ– âˆ§ s + sum xs = sum xsâ‚€ 